; -*- mode: change-log -*-
; Tento dokument obsahuje chronologický seznam nových u¾ivatelských vlastností
; a opravených chyb.  Dodr¾ujte prosím formát.  Nejprve jsou nové
; vlastnosti (na ka¾dou vlastnost jeden odstavec) a potom bugfixy, ka¾dý
; uvozen "* BUGFIX:"

2005-12-09  Tomas Cerha  <cerha@brailcom.org>

	Nová tøída `CheckItem' umo¾òuje definovat polo¾ku menu, které se v
	konstruktoru pøedá funkce `state', která za bìhu zjistí stav
	polo¾ky.

	Menu oken pøepsáno s pou¾itím této nové vlastnosti, kterou dìdí i
	`RadioItem'.
	
	* BUGFIX: Spojovací operátory ("a zároveò" / "a nebo") by ji¾ mìly
	bát správnì pøi vytváøení podmínky pomocí "Filtrovat podle buòky".
	
	* BUGFIX: O¹etøen pøípad, kdy v hlavním formuláøi dualformu není
	vybrán ¾ádný øádek.  To se nìkdy stávalo po úpravì dat horního
	formuláøe a zpùsobovalo to traceback.

	* BUGFIX: V rámci kódu pøepoèítávací funkce cmputeru je nyní
	mo¾né zjistit pùvodní hodnotu sebe sama bez rizika rekurze.  Tím
	je mo¾né napø. za urèitých podmínek ponechat hodnotu políèka
	nezmìnìnou (vrátit pøedchozí hodnotu).
	
	* BUGFIX: Pøi zmìnì ¹írky sloupce z klávesnice se nyní aktualizují
	i scrollbary.
	
	* BUGFIX: "Filtrovat podle buòky" se ji¾ nehroutí na virtuálním
	sloupci.  Zobrazí se jen zpráva, ¾e to nelze.
	
2005-12-07  Tomas Cerha  <cerha@brailcom.org>

	Specifikace èíselníku se nyní naèítá a¾ v konstruktoru formuláøe.
	V dùsledku se napø. pøi pou¾ití `run_cb()' (pytis-extensions)
	automaticky pou¾ijí sloupce definované v `cb_spec()'

        Klávesové zkratky 'Alt-Right' a 'Alt-Left' (levá a pravá ¹ipka)
	nyní umo¾òují interaktivnì mìnit ¹íøku aktuálního sloupce.
	
        Funkce `run_procedure()' a `user_cmd()' (pytis-extensions) nyní
	pøijímají argument `block_refresh_' a pokud je pravdivý, tak
	obalují proceduru, resp. handler pøíkazu funkcí `block_refresh()',
	tak¾e po dobu jejich provádìní se neprovádí ¾ádné refreshe.  Pokud
	je to tøeba, je nutno pøípadný refresh nakonec zavolat ruènì.
	
	* BUGFIX: Øazení klikáním na záhlaví sloupce ji¾ funguje i na
	primárnì øazeném sloupci.

	* BUGFIX: Opraveny nefunkèní agregaèní funkce ve vedlej¹ím
	formuláøi dualformu.  Døíve docházelo k tomu, ¾e filtraèní dialog
	(ve kterém se agregaèní funkce poèítají) byl inicializován pouze
	pøi prvním spu¹tìní aktuální datovou podmínkou platnou pro aktivní
	øádek hlavního formuláøe.  Pøi pøechodu na jiný øádek se data
	dolního formuláøe zmìnila, ale agregaèní funkce pracovaly poøád se
	stejnými daty.
	
2005-12-06  Tomas Cerha  <cerha@brailcom.org>

	Èíselníkové políèko typu ListField nyní umo¾òuje nezávislý pohyb
	kurzoru a výbìr.  Døíve výbìr v¾dy následoval kurzor, co¾
	znemo¾òovalo napøíklad scrollovat hodnoty pomocí klávesnice.

	Blokování refreshe nyní funguje i pøi jeho vnoøeném pou¾ití a je
	mo¾né pøedat argumenty volané funkce.  Byly také odstranìny
	nìkteré døívìj¹í hacky, které øe¹ily blockování refreshe po svém.
	
	* BUGFIX: O¹etøena ztráta focusu pøi uzavøení filtrovacího diaogu
	nad duálním formuláøem, kvùli které pøestávalo fungovat
	zobrazování aktivního øádku ve stavové øádce.

	* BUGFIX: Focus je nyní pøi otevøení duálního formuláøe nahoøe.
	
2005-12-05  Tomas Cerha  <cerha@brailcom.org>

	Nová funkce `block_refresh' umo¾òuje zablokovat refresh po dobu
	vykonávání bloku kódu.  To je vhodné zejména pøi definici procedur
	v defsech, kde automatické refreshe èasto zdr¾ují a pøitom postaèí
	jeden refresh a¾ na konci série operací.

	* BUGFIX: Opravena drobná chybka znemo¾òující tisk pomocí
	klávesové zkratky.

	* BUGFIX: Opraveno havarování pøi zobrazení více dialogù.
	
	* BUGFIX: Filtrovací dialog si nyní opìt správnì zapamatuje
	podmínku.

	* BUGFIX: Nastavování velikostí prvkù filtrovacích dialogù
	upraveno pro nové verze wx.

2005-12-01  Tomas Cerha  <cerha@brailcom.org>

	Tiskové menu se nyní nevytváøí v menubaru aplikace, ale ka¾dý
	formuláø má tlaèítko, kterým lze menu vyvolat.  Je tím vyøe¹en
	problém tiskového menu v duálním formuláøi.

2005-11-29  Tomas Cerha  <cerha@brailcom.org>

	Dialogy nyní pou¾ívají systémové ikony, tak¾e jednak není nutné
	distribuovat ikony spoleènì s Pytisem (a nastavovat cesty atd.) a
	jednak ikony odpovídají zvolenému systémovému tématu (jsou
	vìt¹inou mnohem hezèí, ne¾ ty, které jsme mìli).

	* BUGFIX: Opraven nefunkèní `OperationDialog'.

	* BUGFIX: Nastavení výchozího tlaèítka dialogu by ji¾ mìlo
	fungovat.
	
	* BUGFIX: Klávesy v dialozích by se ji¾ mìly chovat pøirozenìji.
	
	* BUGFIX: Editable.ONCE nyní funguje správnì i v inline editaci.
	
2005-11-29  Tomas Cerha  <cerha@brailcom.org>

	* BUGFIX: Kalendáøový dialog by ji¾ mìl správnì reagovat ve v¹ech
	verzích wxWidgets.
	
	* BUGFIX: O¹etøeny výjimky resloveru pøi zji¹»ování výchozího
	tøídìní èíselníku.

2005-11-28  Tomas Cerha  <cerha@brailcom.org>

	Nová konfiguraèní volba `dbport' (a argument pøíkazové øádky)
	umo¾òuje nastavit port databázového spojení.  `dbhost' nyní
	funguje i jako argument pøíkazové øádky.
 	
	ListField nyní reaguje na koleèko my¹i.

	* BUGFIX: Pøi vyvolání prázdného èíselníku nezobrazuj chybovou
	hlá¹ku "Záznam nenalezen".

	* BUGFIX: Needitovatelný ListField lze nyní scrollovat (my¹í).

	* BUGFIX: Focus ji¾ v duálním formuláøi nepøeskakuje pøi pøechodu
	na záznam, ke kterému v dolním formuláøi nejsou ¾ádné polo¾ky.
	Tato chyba byla pravdìpodobnì odstranìna nìkterou pøedchozí
	úpravou.  Dnes bylo správné chování pouze zji¹tìno.

	* BUGFIX: Vyvolání èíselníku v inline editaci.
	
2005-11-25  Tomas Cerha  <cerha@brailcom.org>

	Odstranìn doèasný hack v PresentedRow._init_row.genval()
	umo¾òující pou¾ití computeru namísto funkce `default'.  Nyní je
	tedy nutné ve specifikacích v¾dy rozli¹ovat.  Default je pro
	výpoèet hodnoty pøi inicializaci nového záznamu, computer pro
	prùbì¾né dopoèítávání a výpoèet hodnot virtuálních políèek.

	* BUGFIX: Vyøe¹en problém sdílení Enumerátorù projevující se
	výrazným zpomalením pøi pou¾ití ListField v DescriptiveDualFormu.
	
2005-11-24  Tomas Cerha  <cerha@brailcom.org>

	Argument 'sorting' v CodebookSpec se nyní skuteènì projeví pøi
	zobrazení èíselníku.
      	
	* BUGFIX: V DescriptiveDualForm byl pøi výbìru pøedáván do
	vedlej¹ího formuláøe celý PresentedRow, tak¾e nedocházelo správnì
	k aktualizaci RuntimeFilterù a dal¹ích závislostí.  Opraveno
	nastavováním pouze pøes datový øádek.

	* BUGFIX: Vèerej¹í bugfix zpùsobil problémy s computery pøi
	inicializaci prázdného PresentedRow v EditFormu.  Dne¹ní oprava v
	DescriptiveDualFormu v¹ak øe¹í i problém s neinicializovanými
	filtry, tak¾e vèerej¹í úprava mohla být zase zru¹ena.

	* BUGFIX: ListField nyní zachovává nastavenou hodnotu i po
	pøenaètení dat (zmìna runtime-filteru).

2005-11-23  Tomas Cerha  <cerha@brailcom.org>

        V CodebookSpec lze nyní pøedefinovat také tøídìní argumentem
	'sorting'.  Zatím se to nikde neprojeví, ale lze toho ji¾ vyu¾ívat
	ve specifikacích a brzo se snad dostaneme i k implementaci.  Sní¾í
	se tak poèet potøebných variant v defsech.

	V pytis-extensions pøibyla nová funkce enum(), umo¾òující
	jednodu¹e vytvoøit DataEnumerator pro arguemnt 'enumerator'
	datového typu.

	* BUGFIX: V ListField jsou nyní správnì zobrazovány i víceøádkové
	polo¾ky.

	* BUGFIX: Odstranìn problém s "Insufficient runtime filter"
	zpùsobený neinicializovanými filtry ve formuláøích, které
	nevytváøely PresentedRow v konstruktoru.

	* BUGFIX: Opraveno chování specifikátoru 'default'.  Nyní je
	funkce volána pouze pøi vytváøení nového øádku.

2005-11-22  Tomas Cerha  <cerha@brailcom.org>

	* BUGFIX: None nech» je platným argumentem 'select_row()'.

	* BUGFIX: Vnoøené volání hookù pøi zmìnì runtime filteru
	enumerátoru.

	* BUGFIX: PresentedRow nyní správnì øe¹í ve¹keré závislosti a
	pøepoèítávání i pro virtuální políèka.
	
2005-11-21  Tomas Cerha  <cerha@brailcom.org>

	Nový typ èíselníkového políèka urèený pomocí `SelectionType.LIST'.
	Toto políèko nahrazuje pùvodní seznamové políèko urèené pomocí
	'RefSpec' a argumentu 'references'.  Argument 'references' je nyní
	nefunkèní a jeho pou¾ití je pouze logováno.  Bude tøeba ho v¹ude
	odstranit a nahradit èíselníkem s vý¹e zmínìným 'selection_type'.
	Tato nová implementace umo¾òuje daleko sna¾¹í práci se seznamem,
	mo¾nost pøímého získání vybrané hodnoty (napø. v computerech),
	získání hodnoty libovolného sloupce vybraného øádku a dal¹í
	mo¾nosti *sdandardnì* podporované èíselníkovými políèky.
	Odstraòuje také nìkolik velice nepøíjemných hackù, které byly
	nutné kvùli døívìj¹í implementaci a pomìrnì neprùhledné a zcela
	nestandardní chování.  Kromì nového typu 'selection_type' nejsou
	na stranì specifikace nyní pou¾ity ¾ádné speciality.  K filtrování
	záznamù v seznamu podle aktuálních dat formuláøe je mo¾né pou¾ít
	'codebook_runtime_filter'.  V¹e je tak plnì v souladu se za¾itou
	koncepcí systému.

	Zprùhlednìní zpracování arguemntu 'selection_type' ve 'FieldSpec'
	a pøiøazení výchozích hodnot.  Pøidány asserty upozoròující na
	nesprávnou kombinaci 'selection_type' a 'codebook' ve specifikaci.

2005-11-18  Tomas Cerha  <cerha@brailcom.org>

	* BUGFIX: Opraveno nefunkèní nastavení editovatelnosti políèek.

	* BUGFIX: Nezobrazuj chybový dialog, kdy¾ nelze nalézt pùvodní
	záznam po vyvolání funkce kontextového menu v BrowseFromu.

	* BUGFIX: Displej se nyní nezobrazí, pokud má nastavenu nulovou
	¹íøku.

2005-11-16  Tomas Cerha  <cerha@brailcom.org>

	* BUGFIX: Chybné skládání klávesových zkratek a následé padání pøi
	zobrazení popup-menu.

2005-11-15  Tomas Cerha  <cerha@brailcom.org>

	* BUGFIX: Nechtìné nalíznutí sekvencí pøi otevírání formuláøù
	odvozených z EditForm (nadbyteèná inicializace prázdného záznamu).
   
2005-11-09  Tomas Cerha  <cerha@brailcom.org>

	* BUGFIX: Nekorektní chování metody `Data.search()' v tabulce s
	NULL hodnotami ve sloupci, podle kterého je tøídìno.
